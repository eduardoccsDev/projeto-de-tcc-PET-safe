import{_ as E,r as h,h as m,o as a,c as n,a as s,w as N,v as $,e as i,F as C,q as x,d as b,t as g,p as B,j as U}from"./index-077e0b24.js";const c=p=>(B("data-v-86566fb2"),p=p(),U(),p),R={class:"container"},V=c(()=>s("section",{class:"page__title"},[s("h1",null,"Clínicas veterinárias próximas de você")],-1)),z=c(()=>s("hr",null,null,-1)),P={class:"user-address"},q=c(()=>s("label",{for:"userAddress"},[s("i",{class:"fa-solid fa-location-dot"}),i(" Seu endereço:")],-1)),D=c(()=>s("i",{class:"fa-solid fa-magnifying-glass"},null,-1)),M=c(()=>s("i",{class:"fa-solid fa-globe"},null,-1)),F={class:"clinics-list"},K={key:0,class:"clinicsContainer"},O={key:0},H=["src","alt"],L={class:"clinicInfo"},T={key:0,class:"clinicStatus"},j=c(()=>s("i",{class:"fa-solid fa-door-open"},null,-1)),G={key:1,class:"clinicStatus"},W=c(()=>s("i",{class:"fa-solid fa-door-closed"},null,-1)),X={class:"clinicRating"},Y=c(()=>s("i",{class:"fa-solid fa-star"},null,-1)),J={class:"clinicAddress"},Q=c(()=>s("i",{class:"fa-solid fa-map-location-dot"},null,-1)),Z=["href"],ee={key:1},se={__name:"NearbyClinics",setup(p){const d=h(null),r=h(""),f=h(""),y=localStorage.getItem("token");y&&m.get("https://node-mysl-api.onrender.com/protegido",{headers:{Authorization:`Bearer ${y}`}}).then(o=>{d.value=o.data.user,f.value=d.value.cepuser,r.value=d.value.addressuser+"-"+f.value}).catch(o=>{console.error("Erro ao acessar o endpoint protegido:",o)});const w=()=>{r.value="","geolocation"in navigator?navigator.geolocation.getCurrentPosition(async o=>{const t=o.coords.latitude,e=o.coords.longitude,l=await A(t,e);r.value=l}):alert("A geolocalização não é suportada pelo seu navegador.")},A=async(o,t)=>{const l=`https://maps.googleapis.com/maps/api/geocode/json?latlng=${o},${t}&key=AIzaSyCcR7yUn_K1EmYVI7PMBeXN_tOxSde2tHw`;try{const v=(await m.get(l)).data.results;return v&&v.length>0?v[0].formatted_address:"Endereço não encontrado"}catch(u){return console.error("Erro ao obter endereço:",u),"Erro ao obter endereço"}};d&&d.addressuser&&(r.value=d.addressuser,k());const _=h([]),k=async()=>{if(!r.value){alert("Por favor, insira seu endereço ou use a geolocalização para continuar.");return}const o="https://node-mysl-api.onrender.com/google-maps-proxy",t=`veterinary+clinic+near+${r.value}`;try{const l=(await m.get(o,{params:{query:t}})).data.results;l&&l.length>0?_.value=l:(_.value=[],console.log("Nenhuma clínica veterinária encontrada nas proximidades."))}catch(e){console.error("Erro na pesquisa de clínicas veterinárias:",e)}},I=o=>`https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference=${o.photo_reference}&key=AIzaSyCcR7yUn_K1EmYVI7PMBeXN_tOxSde2tHw`,S=o=>`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(o)}`;return(o,t)=>(a(),n("div",R,[V,z,s("div",P,[q,N(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),onInput:t[1]||(t[1]=e=>r.value=e.target.value),placeholder:"Digite seu endereço"},null,544),[[$,r.value]]),s("button",{onClick:k},[D,i(" Buscar Clínicas ")]),s("button",{onClick:w},[M,i(" Geolocalização ")])]),s("div",F,[_.value.length>0?(a(),n("div",K,[(a(!0),n(C,null,x(_.value,e=>(a(),n("div",{class:"clinicsCard",key:e.place_id},[e.photos&&e.photos.length>0?(a(),n("div",O,[(a(!0),n(C,null,x(e.photos,(l,u)=>(a(),n("div",{key:u},[s("img",{class:"clinicImg",src:I(l),alt:`Photo ${u+1}`},null,8,H)]))),128))])):b("",!0),s("div",L,[s("h3",null,g(e.name),1),e.opening_hours&&e.opening_hours.open_now===!0?(a(),n("p",T,[j,i(" ABERTO ")])):e.opening_hours&&e.opening_hours.open_now===!1?(a(),n("p",G,[W,i(" FECHADO ")])):b("",!0),s("p",X,[Y,i("Avaliação Média: "+g(e.rating)+" - de "+g(e.user_ratings_total)+" avaliações ",1)]),s("p",J,[Q,i(" Enereço: "),s("a",{href:S(e.formatted_address),target:"_blank"},g(e.formatted_address),9,Z)])])]))),128))])):(a(),n("p",ee,"Nenhum resultado encontrado."))])]))}},te=E(se,[["__scopeId","data-v-86566fb2"]]);export{te as default};
